---
title: "Functional ANOVA: Analyze Simulated Data Using JAGS"
date: '`r format(Sys.Date(), "%B %d, %Y")`'
output:
  html_document:
    keep_md: true
  pdf_document: default
---





```{r setup, include=FALSE}

## Install/load packages
pkgs = c("knitr","ggplot2","RColorBrewer")
for(p in pkgs) if(p %in% rownames(installed.packages()) == FALSE) {install.packages(p, dependencies = TRUE)}
for(p in pkgs) suppressPackageStartupMessages(library(p, quietly=TRUE, character.only=TRUE))
rm(p, pkgs)

## Load the analysis results
load("output/analysisresults.rda")

```





## Simulate Three-Group One-Way Functional ANOVA Data

Three-group one-way functional ANOVA data were simulated using methods described in the paper "Fast Function-on-Scalar Regression with Penalized Basis Expansions" from Reiss et al:

$$
\begin{aligned}
y_{i}(t) &= \mu(t) + \beta_{gp(i)}(t) + \epsilon_{i}(t) \\
\mu(t) &= 0.4\arctan(10x - 5) + 0.6 \\
\beta_{1}(t) &= -0.5 e^{-10t} -0.04\sin(8t) - 0.3t + 0.5 \\
\beta_{2}(t) &= -(t - 0.5)^{2} - 0.15 \sin(13t) \\
\beta_{3}(t) &= -\beta_{1}(t) - \beta_{2}(t)
\end{aligned}
$$
where $t = m/200$ for $m=0,\dots,200$ and the error functions, $\epsilon_{i}(t)$, were simulated from a mean-zero Gaussian process with coveriance $V(s,t) = \sigma_{1} 0.15^{|s-t|} + \sigma_{2} \delta_{st}$ where $\delta_{st}=1$ if $s=t$ and $0$ otherwise. For the simulations, N=`r N` curves were simulated for each of the 3 groups, $\sigma_{1} = 0.15$, and $\sigma_{2} = 0.05$. So, we have `r nrow(dat)` observations from `r N*g` curves with `r N` curves per group.



<br>
<br>
\pagebreak

#### Figure 1: The true effect functions along with the simulated data.
```{r, echo=FALSE, fig.align="center", fig.width=8, fig.height=6}

figure1

```




<br>
<br>
\pagebreak

#### Figure 2: The smoothed subject-specific curves from the simulated data.
```{r, echo=FALSE, fig.align="center", fig.width=8, fig.height=6}

figure2

```




<br>
<br>
\pagebreak

#### Figure 3: The group-level mean functions for the smoothed simulated data $\pm$ 2 point-wise standard deviations.
```{r, echo=FALSE, fig.align="center", fig.width=8, fig.height=6}

figure3

```





<br>
<br>
\pagebreak

## Analyze Using lm()

#### Figure 4: The group-level mean functions from lm() using a 5th-order linear model with time-by-group and $\text{Time}^2$-by-group interactions.
```{r, echo=FALSE, fig.align="center", fig.width=8, fig.height=6}

figure4

```





<br>
<br>
\pagebreak

## Analyze Using Penalized Splines and lme()

#### Figure 5: The group-level mean functions using penalized splines and lme().
```{r, echo=FALSE, fig.align="center", fig.width=8, fig.height=6}

figure5

```





<br>
<br>
\pagebreak

## Analyze Using JAGS

#### Figure 6: The group-level mean functions from JAGS using a 5th-order linear model with time-by-group and $\text{Time}^2$-by-group interactions.
```{r, echo=FALSE, fig.align="center", fig.width=8, fig.height=6}

figure6

```





<br>
<br>
\pagebreak

## Analyze Using Penalized Splines and JAGS

#### Figure 7: The group-level mean functions using penalized splines and JAGS.
```{r, echo=FALSE, fig.align="center", fig.width=8, fig.height=6}

figure7

```





<br>
<br>
\pagebreak

## Session Info

A summary of the R session used for the analysis.
```{r, echo=FALSE}

print(sessionInfo(), local = FALSE)

```



